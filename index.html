<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±¥æ­´ä½œæˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ Professional AI</title>
    <style>
        :root { --primary: #0056b3; --success: #28a745; --ai-color: #6200ee; --bg: #f8f9fa; }
        body { font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif; background-color: var(--bg); padding: 20px; line-height: 1.6; }
        .container { max-width: 1100px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h2 { color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px; margin-top: 0; display: flex; justify-content: space-between; align-items: center; }
        .tabs { display: flex; gap: 8px; margin-bottom: 25px; flex-wrap: wrap; }
        .tab-btn { padding: 12px 20px; cursor: pointer; border: 1px solid #ddd; background: #fff; border-radius: 6px; transition: 0.3s; font-weight: bold; }
        .tab-btn:hover { background: #f0f0f0; }
        .tab-btn.active { background: var(--primary); color: #fff; border-color: var(--primary); }
        .grid-form { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .form-group { display: flex; flex-direction: column; }
        .full-width { grid-column: 1 / -1; }
        .section-title { grid-column: 1 / -1; background: #f0f4f8; padding: 5px 10px; font-weight: bold; border-left: 4px solid var(--primary); margin-top: 10px; font-size: 0.9em; }
        label { font-size: 0.8em; font-weight: bold; margin-bottom: 3px; color: #555; }
        input, textarea, select { padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px; }
        textarea { min-height: 60px; resize: vertical; }
        
        .ai-section { margin: 15px 0; grid-column: 1 / -1; }
        .ai-btn { background: var(--ai-color); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; width: 100%; font-weight: bold; font-size: 15px; }
        .loading-text { display: none; font-size: 0.9em; color: var(--ai-color); margin-top: 5px; text-align: center; font-weight: bold; }

        .output-container { margin-top: 30px; background: #2d3436; padding: 20px; border-radius: 8px; color: #dfe6e9; }
        #output { white-space: pre-wrap; font-family: monospace; font-size: 13px; line-height: 1.4; background: #1e272e; padding: 15px; border-radius: 5px; border: 1px solid #3d4e5f; min-height: 100px; }
        .copy-btn { margin-top: 15px; padding: 15px; background: var(--success); color: #fff; border: none; border-radius: 6px; cursor: pointer; width: 100%; font-size: 16px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“‹ å±¥æ­´ä½œæˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ Professional</h2>
    <div class="tabs" id="tabs">
        <button class="tab-btn active" onclick="renderForm('juden')">å—é›»</button>
        <button class="tab-btn" onclick="renderForm('kaden')">æ¶é›»</button>
        <button class="tab-btn" onclick="renderForm('cancel')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="tab-btn" onclick="renderForm('denki')">é›»æ°—å»ƒæ­¢</button>
        <button class="tab-btn" onclick="renderForm('gas')">ã‚¬ã‚¹å»ƒæ­¢</button>
        <button class="tab-btn" onclick="renderForm('letter')">ã‚µãƒ³ã‚­ãƒ¥ãƒ¼ãƒ¬ã‚¿ãƒ¼</button>
    </div>

    <div id="form-content" class="grid-form"></div>

    <div id="ai-area" class="ai-section" style="display: none;">
        <button class="ai-btn" id="run-ai" onclick="runGeminiAI()">âœ¨ AIã§å†…å®¹ã‚’è¦ç´„ãƒ»è‡ªå‹•ä¿®æ­£ã™ã‚‹</button>
        <div id="loading" class="loading-text">GeminiãŒå†…å®¹ã‚’åˆ†æã—ã¦æœ€é©ãªæ–‡ç« ã‚’ä½œæˆä¸­...</div>
    </div>

    <div class="output-container">
        <div id="output"></div>
        <button class="copy-btn" onclick="copyToClipboard()">å±¥æ­´ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦çµ‚äº†</button>
    </div>
</div>

<script>
    const GEMINI_API_KEY = "AIzaSyDFJJ0kYoVTOk001elvqJDdBAx6YjC2UGg";

    const configs = {
        juden: {
            title: "",
            fields: [
                { id: "moushikomi", label: "ç”³è¾¼æ›¸ç•ªå·", type: "text" },
                { id: "datetime", label: "å—é›»æ—¥æ™‚", type: "text", value: () => new Date().toLocaleString() },
                { id: "tel", label: "å…¥é›»ç•ªå·", type: "text" },
                { id: "sender", label: "å…¥é›»è€…", type: "text" },
                { id: "window", label: "çª“å£å", type: "text", prefix: "ã€", suffix: "ã€‘" },
                { id: "content", label: "ã€å•åˆã›å†…å®¹ã€‘", type: "textarea", full: true },
                { id: "ans", label: "ã€å›ç­”ã€‘", type: "textarea", full: true }
            ],
            ai: true
        },
        kaden: {
            title: "",
            fields: [
                { id: "datetime", label: "æ¶é›»æ—¥æ™‚", type: "text", value: () => new Date().toLocaleString() },
                { id: "tel", label: "æ¶é›»ç•ªå·", type: "text" },
                { id: "content", label: "ã€æ¶é›»å†…å®¹ã€‘", type: "textarea", full: true },
                { id: "result", label: "ã€æ¶é›»çµæœã€‘", type: "textarea", full: true }
            ],
            ai: true
        },
        cancel: {
            title: "ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‘",
            fields: [
                { id: "sw_date", label: "ã‚¹ã‚¤ãƒƒãƒãƒ³ã‚°æ—¥", type: "text" },
                { id: "tel", label: "â—å…¥é›»ç•ªå·", type: "text" },
                { id: "reason", label: "â—ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç†ç”±", type: "text" }
            ]
        },
        denki: {
            title: "ã€é›»æ°—å»ƒæ­¢ã€‘",
            fields: [
                { id: "moushikomi", label: "â—ç”³è¾¼æ›¸ç•ªå·", type: "text" },
                { id: "addr", label: "â—è§£ç´„ä½æ‰€", type: "text" },
                { id: "range", label: "â—ä¸€éƒ¨æ‹ ç‚¹å»ƒæ­¢/å…¨æ‹ ç‚¹å»ƒæ­¢", type: "select", options: ["å…¨æ‹ ç‚¹å»ƒæ­¢", "ä¸€éƒ¨æ‹ ç‚¹å»ƒæ­¢"] },
                { id: "point", label: "â—å»ƒæ­¢ã™ã‚‹åœ°ç‚¹", type: "text" },
                { id: "hope_date", label: "â—è§£ç´„å¸Œæœ›æ—¥", type: "text" },
                { id: "end_date", label: "â—å»ƒæ­¢æ—¥", type: "text", suffix: "\n(20â—â—/â—/â—ã¾ã§åˆ©ç”¨ã™ã‚‹ï¼ä¾é ¼ç®¡ç†ã¨åŒä¸€)" },
                { id: "reason", label: "â—å»ƒæ­¢ç†ç”±", type: "text" },
                { id: "kaitai_select", label: "â—è§£ä½“ã‚ã‚Š/ãªã—ãƒ»ç«‹ä¼šã‚ã‚Š/ãªã—", type: "select", options: ["è§£ä½“ãªã—ãƒ»ç«‹ä¼šãªã—", "è§£ä½“ã‚ã‚Šãƒ»ç«‹ä¼šã‚ã‚Š", "è§£ä½“ã‚ã‚Šãƒ»ç«‹ä¼šãªã—", "è§£ä½“ãªã—ãƒ»ç«‹ä¼šã‚ã‚Š"], suffix: "\nï¼ˆè§£ä½“æœ‰ã®å ´åˆã€åŸå‰‡ã€å»ƒæ­¢ç¿Œæ—¥ä»¥é™æœŸæ—¥è¨­å®šï¼‰" },
                { id: "kaitai_date", label: "ï¼ˆè§£ä½“ã‚ã‚Šã®å ´åˆï¼‰â—ãƒ¡ãƒ¼ã‚¿ãƒ¼æ’¤å»æ—¥æ™‚", type: "text", placeholder: "ã€‡ã€‡ã€‡ã€‡/ã€‡/ã€‡ ã€‡æ™‚" },
                { id: "kaitai_contact", label: "ï¼ˆè§£ä½“ã‚ã‚Šã€ã‹ã¤ã€ç«‹ä¼šã‚ã‚Šã®å ´åˆï¼‰â—ç«‹ä¼šæ‹…å½“/è§£ä½“æ¥­è€…", type: "text", prefix: "é€£çµ¡å…ˆï¼š" },
                { id: "witness_date", label: "ï¼ˆè§£ä½“ã‚ã‚Šã€ã‹ã¤ã€ç«‹ä¼šã‚ã‚Šã®å ´åˆï¼‰â—ç«‹ä¼šäºˆå®šæ—¥", type: "text", placeholder: "ã€‡ã€‡ã€‡ã€‡/ã€‡/ã€‡ ã€‡æ™‚", suffix: "\nâ†’è§£ä½“æœ‰ã®å ´åˆã¯ã€è§£ä½“æ—¥ã¾ã§è¨˜è¼‰å¿…é ˆ" },
                { id: "send_change", label: "â—è«‹æ±‚æ›¸é€ä»˜å…ˆå¤‰æ›´è¦å¦", type: "select", options: [
                    "ä¸è¦ï¼šDBä¸Šã®é€ä»˜å…ˆã¸å±Šãï¼ˆä»–åœ°ç‚¹ã¯ç¶™ç¶šã®ç‚ºï¼‰",
                    "ä¸è¦ï¼šåŒä½æ‰€ã§ã€åŒä¸€å•†å·ã§ã€äº‹æ¥­ã‚’ç¶™ç¶šã™ã‚‹ã€‚",
                    "å¿…è¦ï¼šå»ºç‰©ã‚’è§£ä½“ã™ã‚‹ç‚ºã€ç¾é€ä»˜å…ˆã¸ã¯å±Šã‹ãªã„ã€‚",
                    "å¿…è¦ï¼šä½æ‰€ã¯å¤‰æ›´ãªã—ã ãŒã€å®›åã‚’â—â—æ–¹ã¨ä»˜è¨˜ã—ã¦ã»ã—ã„ã€‚"
                ]},
                { id: "new_addr", label: "â—å¤‰æ›´å…ˆ", type: "text" },
                { id: "atena", label: "â—å®›å", type: "text" },
                { id: "after_tel", label: "â—è§£ç´„å¾Œé€£çµ¡å…ˆ", type: "text" },
                { id: "other_no", label: "â—ä»–ç”³è¾¼ç•ªå·", type: "select", options: ["ç„¡", "æœ‰"] },
                { id: "other_no_val", label: "â€»æœ‰ã®å ´åˆã€è©²å½“ç”³è¾¼ç•ªå·", type: "text" },
                { id: "cont_point", label: "â—åŒä¸€ç”³è¾¼æ›¸ç•ªå·ç¶™ç¶šæ‹ ç‚¹", type: "select", options: ["ç„¡", "æœ‰"] },
                { id: "cont_point_val", label: "â€»æœ‰ã®å ´åˆã€è©²å½“åœ°ç‚¹ç•ªå·", type: "text" },
                { id: "penalty", label: "â—é•ç´„é‡‘", type: "text", suffix: " å††\nâ€»è§£ç´„äº‹å‹™æ‰‹æ•°æ–™+ç‰¹åˆ¥è¿½åŠ å‰²å¼•ãŒã‚ã‚‹å ´åˆã¯æ¡ˆå†…" },
                { id: "long_waribiki", label: "â—é•·æœŸå‰²OPèª¬æ˜", type: "select", options: ["æ¡ˆå†…æ¸ˆã¿", "ä»˜å¸¯ãªã—"] },
                { id: "last_bill", label: "â—æœ€çµ‚è«‹æ±‚ã®æ™‚æœŸãƒ»è«‹æ±‚ãšã‚Œ", label2: "æ¡ˆå†…ãšã¿", type: "text", value: "æ¡ˆå†…ãšã¿" },
                { id: "cvs_pay", label: "â—ã‚³ãƒ³ãƒ“ãƒ‹æ‰•ã„ã®å¯èƒ½æ€§", type: "text", value: "æ¡ˆå†…ãšã¿" },
                { id: "death_sec", label: "ã€Šå¥‘ç´„è€…ï¼ˆå±‹å·/å€‹äººï¼‰æ­»äº¡ã®å ´åˆã€‹â€»æ³•äººã¯é™¤å¤–", type: "header" },
                { id: "death_info", label: "æ­»äº¡è¨¼æ˜æå‡ºæ¡ˆå†…æ¸ˆã¿", type: "text", value: "åœ°åŸŸå‰µç”Ÿæœ¬ç¤¾ã¸éƒµé€" },
                { id: "death_mou", label: "ç”³è¾¼æ›¸ç•ªå·è¨˜è¼‰æ¡ˆå†…æ¸ˆã¿", type: "text", value: "æ¡ˆå†…æ¸ˆã¿" }
            ]
        },
        gas: { title: "ã€ã‚¬ã‚¹å»ƒæ­¢ã€‘", fields: [{ id: "reason", label: "ç†ç”±", type: "text" }] },
        letter: { title: "ã€ã‚µãƒ³ã‚­ãƒ¥ãƒ¼ãƒ¬ã‚¿ãƒ¼ã€‘", fields: [{ id: "reason", label: "ç†ç”±", type: "text" }] }
    };

    let currentTab = 'juden';

    function renderForm(tab) {
        currentTab = tab;
        const conf = configs[tab];
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.innerText.includes(tab === 'denki' ? 'é›»æ°—' : (tab === 'gas' ? 'ã‚¬ã‚¹' : tab))));
        document.getElementById('ai-area').style.display = conf.ai ? 'block' : 'none';
        
        const container = document.getElementById('form-content');
        container.innerHTML = '';
        
        conf.fields.forEach(f => {
            if(f.type === 'header') {
                const h = document.createElement('div');
                h.className = 'section-title';
                h.innerText = f.label;
                container.appendChild(h);
                return;
            }

            const div = document.createElement('div');
            div.className = `form-group ${f.full ? 'full-width' : ''}`;
            const label = document.createElement('label');
            label.innerText = f.label;
            div.appendChild(label);
            
            let el;
            if(f.type === 'select') {
                el = document.createElement('select');
                f.options.forEach(o => {
                    const opt = document.createElement('option');
                    opt.value = o; opt.innerText = o;
                    el.appendChild(opt);
                });
            } else if(f.type === 'textarea') {
                el = document.createElement('textarea');
            } else {
                el = document.createElement('input');
                el.type = 'text';
            }
            el.id = f.id;
            if(f.value) el.value = typeof f.value === 'function' ? f.value() : f.value;
            if(f.placeholder) el.placeholder = f.placeholder;
            el.oninput = updatePreview;
            div.appendChild(el);
            container.appendChild(div);
        });
        updatePreview();
    }

    function updatePreview() {
        const conf = configs[currentTab];
        let text = `${conf.title}\n`;
        conf.fields.forEach(f => {
            if(f.type === 'header') { text += `\n${f.label}\n`; return; }
            const el = document.getElementById(f.id);
            if(!el) return;
            const val = el.value || "";
            const prefix = f.prefix || "";
            const suffix = f.suffix || "";
            
            if(f.label.startsWith('ã€')) {
                text += `\n${f.label}\n${val}\n`;
            } else {
                // ãƒ©ãƒ™ãƒ«ã®æœ«å°¾ãŒã€Œï¼šã€ã§çµ‚ã‚ã£ã¦ã„ãªã„ã‚‚ã®ã«ä»˜ä¸
                const labelText = f.label.endsWith('ï¼š') || f.label.endsWith(':') ? f.label : f.label + 'ï¼š';
                text += `${labelText}${prefix}${val}${suffix}\n`;
            }
        });
        document.getElementById('output').innerText = text;
    }

    async function runGeminiAI() {
        const contentEl = document.getElementById('content');
        const ansEl = (document.getElementById('ans') || document.getElementById('result'));
        if (!contentEl.value || !ansEl.value) return alert("å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
        const btn = document.getElementById('run-ai');
        const loader = document.getElementById('loading');
        btn.disabled = true; loader.style.display = "block";

        const prompt = `ã‚³ãƒ¼ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼å±¥æ­´ç”¨ã€‚ä»¥ä¸‹ã®å†…å®¹ã‚’ç°¡æ½”ã«ãƒ“ã‚¸ãƒã‚¹è¦ç´„ã—ã¦JSONå½¢å¼ {"content": "...", "ans": "..."} ã§è¿”ã›ã€‚æŒ¨æ‹¶ä¸è¦ã€‚\nå†…å®¹:${contentEl.value}\nå›ç­”:${ansEl.value}`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }], generationConfig: { responseMimeType: "application/json" } })
            });
            const data = await response.json();
            const result = JSON.parse(data.candidates[0].content.parts[0].text);
            contentEl.value = result.content;
            ansEl.value = result.ans;
            updatePreview();
        } catch (e) { alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"); }
        finally { btn.disabled = false; loader.style.display = "none"; }
    }

    function copyToClipboard() {
        const text = document.getElementById('output').innerText;
        navigator.clipboard.writeText(text).then(() => alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼"));
    }

    renderForm('juden');
</script>
</body>
</html>
